# HTTP ν—¤λ”2 - μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­

## μΊμ‹ κΈ°λ³Έ λ™μ‘

β… μΊμ‹κ°€ μ—†μ„ λ•      

![http_basic_108.png](../img/http_basic_108.png)          
![http_basic_109.png](../img/http_basic_109.png)         

- λ°μ΄ν„°κ°€ λ³€κ²½λμ§€ μ•μ•„λ„ κ³„μ† λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄μ„ λ°μ΄ν„°λ¥Ό λ‹¤μ΄λ΅λ“ λ°›μ•„μ•Ό ν•λ‹¤.         
- μΈν„°λ„· λ„¤νΈμ›ν¬λ” λ§¤μ° λλ¦¬κ³  λΉ„μ‹Έλ‹¤.         
- λΈλΌμ°μ € λ΅λ”© μ†λ„κ°€ λλ¦¬λ‹¤.         
- λλ¦° μ‚¬μ©μ κ²½ν—         
<br/>

β… μΊμ‹ μ μ©         

![http_basic_110.png](../img/http_basic_110.png)          
![http_basic_111.png](../img/http_basic_111.png)          
![http_basic_112.png](../img/http_basic_112.png)          
![http_basic_113.png](../img/http_basic_113.png)          

- μΊμ‹ λ•λ¶„μ— μΊμ‹ κ°€λ¥ μ‹κ°„λ™μ• λ„¤νΈμ›ν¬λ¥Ό μ‚¬μ©ν•μ§€ μ•μ•„λ„ λλ‹¤.          
- λΉ„μ‹Ό λ„¤νΈμ›ν¬ μ‚¬μ©λ‰μ„ μ¤„μΌ μ μλ‹¤.          
- λΈλΌμ°μ € λ΅λ”© μ†λ„κ°€ λ§¤μ° λΉ λ¥΄λ‹¤.          
- λΉ λ¥Έ μ‚¬μ©μ κ²½ν—          
<br/>

β… μΊμ‹ μ‹κ°„ μ΄κ³Ό          

![http_basic_114.png](../img/http_basic_114.png)          
![http_basic_115.png](../img/http_basic_115.png)          
![http_basic_116.png](../img/http_basic_116.png)         

- μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•λ©΄, μ„λ²„λ¥Ό ν†µν•΄ λ°μ΄ν„°λ¥Ό λ‹¤μ‹ μ΅°νν•κ³ , μΊμ‹λ¥Ό κ°±μ‹ ν•λ‹¤.         
- μ΄λ• λ‹¤μ‹ λ„¤νΈμ›ν¬ λ‹¤μ΄λ΅λ“κ°€ λ°μƒν•λ‹¤.         
<br/>

## κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­1

![http_basic_117.png](../img/http_basic_117.png)          

- μΊμ‹ λ§λ£ν›„μ—λ„ μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•μ§€ μ•μ          
- μƒκ°ν•΄λ³΄λ©΄ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•λ” λ€μ‹ μ— μ €μ¥ν•΄ λ‘μ—λ μΊμ‹λ¥Ό μ¬μ‚¬μ© ν•  μ μλ‹¤.          
- λ‹¨ ν΄λΌμ΄μ–ΈνΈμ λ°μ΄ν„°μ™€ μ„λ²„μ λ°μ΄ν„°κ°€ κ°™λ‹¤λ” μ‚¬μ‹¤μ„ ν™•μΈν•  μ μλ” λ°©λ²• ν•„μ”          

![http_basic_118.png](../img/http_basic_118.png)        

β… κ²€μ¦ ν—¤λ” μ¶”κ°€

![http_basic_119.png](../img/http_basic_119.png)          
![http_basic_120.png](../img/http_basic_120.png)          
![http_basic_121.png](../img/http_basic_121.png)          
![http_basic_122.png](../img/http_basic_122.png)          
![http_basic_123.png](../img/http_basic_123.png)          
![http_basic_124.png](../img/http_basic_124.png)          
![http_basic_125.png](../img/http_basic_125.png)          
![http_basic_126.png](../img/http_basic_126.png)          
![http_basic_127.png](../img/http_basic_127.png)          

π― κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­           
- μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•΄λ„, μ„λ²„μ λ°μ΄ν„°κ°€ κ°±μ‹ λμ§€ μ•μΌλ©΄          
- 304 Not Modified + ν—¤λ” λ©”νƒ€ μ •λ³΄λ§ μ‘λ‹µ **(λ°”λ””X β†’ 1.0M)**          
- ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„κ°€ λ³΄λ‚Έ μ‘λ‹µ ν—¤λ” μ •λ³΄λ΅ μΊμ‹μ λ©”νƒ€ μ •λ³΄λ¥Ό κ°±μ‹           
- ν΄λΌμ΄μ–ΈνΈλ” μΊμ‹μ— μ €μ¥λμ–΄ μλ” λ°μ΄ν„° μ¬ν™μ©          
- κ²°κ³Όμ μΌλ΅ λ„¤νΈμ›ν¬ λ‹¤μ΄λ΅λ“κ°€ λ°μƒν•μ§€λ§ μ©λ‰μ΄ μ μ€ ν—¤λ” μ •λ³΄λ§ λ‹¤μ΄λ΅λ“          
- λ§¤μ° μ‹¤μ©μ μΈ ν•΄κ²°μ±…          

<br/>

## κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­2

- **κ²€μ¦ ν—¤λ”**          
    - μΊμ‹ λ°μ΄ν„°μ™€ μ„λ²„ λ°μ΄ν„°κ°€ κ°™μ€μ§€ κ²€μ¦ν•λ” λ°μ΄ν„°          
    - Last-Modified , ETag          
- **μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”**          
    - κ²€μ¦ ν—¤λ”λ΅ μ΅°κ±΄μ— λ”°λ¥Έ λ¶„κΈ°          
    - If-Modified-Since: Last-Modified μ‚¬μ©          
    - If-None-Match: ETag μ‚¬μ©          
    - μ΅°κ±΄μ΄ λ§μ΅±ν•λ©΄ 200 OK          
    - μ΅°κ±΄μ΄ λ§μ΅±ν•μ§€ μ•μΌλ©΄ 304 Not Modified          

<br/>

β… μμ‹          
- If-Modified-Since: μ΄ν›„μ— λ°μ΄ν„°κ°€ μμ •λμ—μΌλ©΄?          
    - **λ°μ΄ν„° λ―Έλ³€κ²½ μμ‹**          
        - μΊμ‹: 2020λ…„ 11μ›” 10μΌ 10:00:00 vs μ„λ²„: 2020λ…„ 11μ›” 10μΌ 10:00:00          
        - **304 Not Modified,** ν—¤λ” λ°μ΄ν„°λ§ μ „μ†΅(BODY λ―Έν¬ν•¨)          
        - μ „μ†΅ μ©λ‰ 0.1M (ν—¤λ” 0.1M, λ°”λ”” 1.0M)          
    - **λ°μ΄ν„° λ³€κ²½ μμ‹**          
        - μΊμ‹: 2020λ…„ 11μ›” 10μΌ 10:00:00 vs μ„λ²„: 2020λ…„ 11μ›” 10μΌ **11**:00:00          
        - **200 OK,** λ¨λ“  λ°μ΄ν„° μ „μ†΅(BODY ν¬ν•¨)          
        - μ „μ†΅ μ©λ‰ 1.1M (ν—¤λ” 0.1M, λ°”λ”” 1.0M)          

<br/>

β… Last-Modified, If-Modified-Since λ‹¨μ           
- 1μ΄ λ―Έλ§(0.xμ΄) λ‹¨μ„λ΅ μΊμ‹ μ΅°μ •μ΄ λ¶κ°€λ¥          
- λ‚ μ§ κΈ°λ°μ λ΅μ§ μ‚¬μ©          
- λ°μ΄ν„°λ¥Ό μμ •ν•΄μ„ λ‚ μ§κ°€ λ‹¤λ¥΄μ§€λ§, κ°™μ€ λ°μ΄ν„°λ¥Ό μμ •ν•΄μ„ λ°μ΄ν„° κ²°κ³Όκ°€ λ‘κ°™μ€ κ²½μ°          
- μ„λ²„μ—μ„ λ³„λ„μ μΊμ‹ λ΅μ§μ„ κ΄€λ¦¬ν•κ³  μ‹¶μ€ κ²½μ°          
    - μ) μ¤νμ΄μ¤λ‚ μ£Όμ„μ²λΌ ν¬κ² μν–¥μ΄ μ—†λ” λ³€κ²½μ—μ„ μΊμ‹λ¥Ό μ μ§€ν•κ³  μ‹¶μ€ κ²½μ°          
<br/>

β… ETag, If-None-Match          
- ETag(Entity Tag)          
- μΊμ‹μ© λ°μ΄ν„°μ— μ„μμ κ³ μ ν• λ²„μ „ μ΄λ¦„μ„ λ‹¬μ•„λ‘           
    - μ) ETag: "v1.0", ETag: "a2jiodwjekjl3"          
- λ°μ΄ν„°κ°€ λ³€κ²½λλ©΄ μ΄ μ΄λ¦„μ„ λ°”κΎΈμ–΄μ„ λ³€κ²½ν•¨(Hashλ¥Ό λ‹¤μ‹ μƒμ„±)          
    - μ) ETag: "aaaaa" -> ETag: "bbbbb"          
- μ§„μ§ λ‹¨μν•κ² ETagλ§ λ³΄λ‚΄μ„ κ°™μΌλ©΄ μ μ§€, λ‹¤λ¥΄λ©΄ λ‹¤μ‹ λ°›κΈ°!          

![http_basic_128.png](../img/http_basic_128.png)          
![http_basic_129.png](../img/http_basic_129.png)          
![http_basic_130.png](../img/http_basic_130.png)          
![http_basic_131.png](../img/http_basic_131.png)          
![http_basic_132.png](../img/http_basic_132.png)          
![http_basic_133.png](../img/http_basic_133.png)          
![http_basic_134.png](../img/http_basic_134.png)          

π― ETag, If-None-Match μ •λ¦¬          
- μ§„μ§ λ‹¨μν•κ² ETagλ§ μ„λ²„μ— λ³΄λ‚΄μ„ κ°™μΌλ©΄ μ μ§€, λ‹¤λ¥΄λ©΄ λ‹¤μ‹ λ°›κΈ°!          
- **μΊμ‹ μ μ–΄ λ΅μ§μ„ μ„λ²„μ—μ„ μ™„μ „ν κ΄€λ¦¬**          
- ν΄λΌμ΄μ–ΈνΈλ” λ‹¨μν μ΄ κ°’μ„ μ„λ²„μ— μ κ³µ(ν΄λΌμ΄μ–ΈνΈλ” μΊμ‹ λ©”μ»¤λ‹μ¦μ„ λ¨λ¦„)          
- μ)          
    - μ„λ²„λ” λ°°νƒ€ μ¤ν” κΈ°κ°„μΈ 3μΌ λ™μ• νμΌμ΄ λ³€κ²½λμ–΄λ„ ETagλ¥Ό λ™μΌν•κ² μ μ§€          
    - μ• ν”λ¦¬μΌ€μ΄μ… λ°°ν¬ μ£ΌκΈ°μ— λ§μ¶”μ–΄ ETag λ¨λ‘ κ°±μ‹           

<br/>

## μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”

β… μΊμ‹ μ μ–΄ ν—¤λ”          
β… Cache-Control: μΊμ‹ μ§€μ‹μ–΄(directives)          
- Cache-Control: max-age
    - μΊμ‹ μ ν¨ μ‹κ°„, μ΄ λ‹¨μ„
- Cache-Control: no-cache
    - λ°μ΄ν„°λ” μΊμ‹ν•΄λ„ λμ§€λ§, ν•­μƒ μ›(origin) μ„λ²„μ— κ²€μ¦ν•κ³  μ‚¬μ©
- Cache-Control: no-store
    - λ°μ΄ν„°μ— λ―Όκ°ν• μ •λ³΄κ°€ μμΌλ―€λ΅ μ €μ¥ν•λ©΄ μ•λ¨ (λ©”λ¨λ¦¬μ—μ„ μ‚¬μ©ν•κ³  μµλ€ν• λΉ¨λ¦¬ μ‚­μ )

β… Pragma: μΊμ‹ μ μ–΄(ν•μ„ νΈν™)

- Pragma: no-cache
- HTTP 1.0 ν•μ„ νΈν™

β… Expires: μΊμ‹ μ ν¨ κΈ°κ°„(ν•μ„ νΈν™)

- expires: Mon, 01 Jan 1990 00:00:00 GMT
- μΊμ‹ λ§λ£μΌμ„ μ •ν™•ν• λ‚ μ§λ΅ μ§€μ •
- HTTP 1.0 λ¶€ν„° μ‚¬μ©
- μ§€κΈμ€ λ” μ μ—°ν• Cache-Control: max-age κ¶μ¥
- Cache-Control: max-ageμ™€ ν•¨κ» μ‚¬μ©ν•λ©΄ Expiresλ” λ¬΄μ‹

β… κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”

- **κ²€μ¦ ν—¤λ” (Validator)**
    - **ETag**: "v1.0", **ETag**: "asid93jkrh2l"
    - **Last-Modified:** Thu, 04 Jun 2020 07:19:24 GMT
- **μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”**
    - If-Match, If-None-Match: ETag κ°’ μ‚¬μ©
    - If-Modified-Since, If-Unmodified-Since: Last-Modified κ°’ μ‚¬μ©

## ν”„λ΅μ‹ μΊμ‹

![http_basic_135.png](../img/http_basic_135.png)          
![http_basic_136.png](../img/http_basic_136.png)          
![http_basic_137.png](../img/http_basic_137.png)          

β… Cache-Control
μΊμ‹ μ§€μ‹μ–΄(directives) - κΈ°νƒ€

- **Cache-Control: public**
    - μ‘λ‹µμ΄ public μΊμ‹μ— μ €μ¥λμ–΄λ„ λ¨
- **Cache-Control: private**
    - μ‘λ‹µμ΄ ν•΄λ‹Ή μ‚¬μ©μλ§μ„ μ„ν• κ²ƒμ„, private μΊμ‹μ— μ €μ¥ν•΄μ•Ό ν•¨(κΈ°λ³Έκ°’)
- **Cache-Control: s-maxage**
    - ν”„λ΅μ‹ μΊμ‹μ—λ§ μ μ©λλ” max-age
- **Age: 60 (HTTP ν—¤λ”)**
    - μ¤λ¦¬μ§„ μ„λ²„μ—μ„ μ‘λ‹µ ν›„ ν”„λ΅μ‹ μΊμ‹ λ‚΄μ— λ¨Έλ¬Έ μ‹κ°„(μ΄)

## μΊμ‹ λ¬΄ν¨ν™”

β… Cache-Control 

ν™•μ‹¤ν• μΊμ‹ λ¬΄ν¨ν™” μ‘λ‹µ

- Cache-Control: no-cache, no-store, must-revalidate
- Pragma: no-cache
    - HTTP 1.0 ν•μ„ νΈν™

β… Cache-Control
μΊμ‹ μ§€μ‹μ–΄(directives) - ν™•μ‹¤ν• μΊμ‹ λ¬΄ν¨ν™”

- **Cache-Control: no-cache**
    - λ°μ΄ν„°λ” μΊμ‹ν•΄λ„ λμ§€λ§, ν•­μƒ **μ› μ„λ²„μ— κ²€μ¦**ν•κ³  μ‚¬μ©(μ΄λ¦„μ— μ£Όμ!)
- **Cache-Control: no-store**
    - λ°μ΄ν„°μ— λ―Όκ°ν• μ •λ³΄κ°€ μμΌλ―€λ΅ μ €μ¥ν•λ©΄ μ•λ¨ (λ©”λ¨λ¦¬μ—μ„ μ‚¬μ©ν•κ³  μµλ€ν• λΉ¨λ¦¬ μ‚­μ )
- **Cache-Control: must-revalidate**
    - μΊμ‹ λ§λ£ν›„ μµμ΄ μ΅°νμ‹ **μ› μ„λ²„μ— κ²€μ¦**ν•΄μ•Όν•¨
    - μ› μ„λ²„ μ ‘κ·Ό μ‹¤ν¨μ‹ λ°λ“μ‹ μ¤λ¥κ°€ λ°μƒν•΄μ•Όν•¨ - 504(Gateway Timeout)
    - must-revalidateλ” μΊμ‹ μ ν¨ μ‹κ°„μ΄λΌλ©΄ μΊμ‹λ¥Ό μ‚¬μ©ν•¨
- **Pragma: no-cache**
    - HTTP 1.0 ν•μ„ νΈν™

β… no-cache VS must-revalidate

- no-cache

β†’ μ› μ„λ²„μ— μ ‘κ·Όν•  μ μ—†λ” κ²½μ°, μΊμ‹ μ„λ²„ μ„¤μ •μ— λ”°λΌ μΊμ‹ λ°μ΄ν„°λ¥Ό λ°ν™ν•  μ μμ

![http_basic_138.png](../img/http_basic_138.png)          
![http_basic_139.png](../img/http_basic_139.png)          
![http_basic_140.png](../img/http_basic_140.png)       

- must-revalidate
β†’ μ›μ„λ²„μ— μ ‘κ·Όν•  μ μ—†λ” κ²½μ°, ν•­μƒ μ¤λ¥κ°€ λ°μƒ

![http_basic_141.png](../img/http_basic_141.png)          




